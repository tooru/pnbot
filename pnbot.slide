Goã§Twitter bot ã‚’ä½œã£ã¦ã¿ãŸğŸ¤
æ¨ªæµœGoèª­æ›¸ä¼š #7
10 Jun 2017

Tooru Takahashi

@dpnbot
@tpnbot

* è©±ã™ã“ã¨

- Twitter Botã¨ã¯
- Goã§ã®Twitter Botã®ä½œã‚Šæ–¹ (æº–å‚™ãƒ»é…ä¿¡å‹ãƒ»å¿œç­”å‹)
- ãƒ‡ãƒ¢
- ã‚„ã£ã¦ã¿ã¦æ‰€æ„Ÿ
- ã¾ã¨ã‚

* Twitter Bot ã¨ã¯

.link http://twinavi.jp/guide/section/twitter/glossary/%E3%83%9C%E3%83%83%E3%83%88%EF%BC%88bot%EF%BC%89%E3%81%A8%E3%81%AF ãƒ„ã‚¤ãƒŠãƒ“ - ãƒœãƒƒãƒˆï¼ˆbotï¼‰ã¨ã¯

 Twitter ã®æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ä½œã‚‰ã‚ŒãŸã€æ©Ÿæ¢°ã«ã‚ˆã‚‹è‡ªå‹•ç™ºè¨€ã‚·ã‚¹ãƒ†ãƒ ã€‚èªæºã¯ãƒ­ãƒœãƒƒãƒˆã‹ã‚‰æ¥ã¦ã„ã‚‹ã€‚
 ç‰¹å®šã®æ™‚é–“ã«è‡ªå‹•ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹ botã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® botå®›ã®ç™ºè¨€ã«ãƒªãƒ—ãƒ©ã‚¤ã™ã‚‹ botã€
 ç‰¹å®šã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«åå¿œã™ã‚‹ bot ç­‰ã€æ§˜ã€…ãª bot ãŒå­˜åœ¨ã™ã‚‹ã€‚

è‡ªå‹•ãƒ„ã‚¤ãƒ¼ãƒˆã®ä¾‹

.link https://twitter.com/traindelay @traindelay é›»è»Šé…å»¶ãªã†
# .link https://twitter.com/kiri_tori @kiri_tori 

ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆä½œæˆã‚µãƒãƒ¼ãƒˆã®äº‹æ¥­ã‚‚ã‚ã‚‹
.link http://ai.userlocal.jp/document/about/ æ ªå¼ä¼šç¤¾ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ã‚«ãƒ« - ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã¨ã¯

æœ€è¿‘ã§ã¯LINE / Facebook / Slack ãŒæœ‰åï¼Ÿ
.link http://appllio.com/20161009-8595-line-reversi-bot LINEãƒˆãƒ¼ã‚¯ä¸Šã§ã€Œãƒªãƒãƒ¼ã‚·ã€ã‚’éŠã¹ã‚‹ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆãŒé¢ç™½ã„

å¤ãã¯ã€ã€IRCã®é ƒã‹ã‚‰
.link http://www.din.or.jp/~ohzaki/uzura.htm äººå·¥ç„¡èƒ½ã†ãšã‚‰(äººå·¥ç—´èƒ½)ã®éƒ¨å±‹


* Goã§ã®Twitter Botã®ä½œã‚Šæ–¹ 1/3 (æº–å‚™)

1. Twitter APIã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
.link https://apps.twitter.com
Twitter APIã‚’å©ãã‚¢ãƒ—ãƒªã‚’ç™»éŒ²ã—ã€API Keyç­‰ã‚’å…¥æ‰‹

2. Twitter Library ã‚’å–å¾—

 $ go get github.com/dghubble/go-twitter/twitter
 $ go get github.com/dghubble/oauth1

ä»Šå›ã¯dghubble/go-twitter ã‚’ä½¿ç”¨ã€ChimeraCoder/anaconda ã‚‚ã‚ˆã•ãã†

ä¸¡æ–¹ã¨ã‚‚Twitter Developer Documentationã«è¼‰ã£ã¦ã„ã‚‹
.link https://dev.twitter.com/resources/twitter-libraries


* Goã§ã®Twitter Botã®ä½œã‚Šæ–¹ 2/3 é…ä¿¡å‹ (ã¤ã¶ã‚„ãæ–¹æ³•)

.code -numbers slide/tweet.go

âš ï¸APIã‚­ãƒ¼ã¯ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã¯å±é™ºã§ã™ã€‚åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ç­‰ã‹ã‚‰å–å¾—ã—ã¾ã—ã‚‡ã†ã€‚

* Goã§ã®Twitter Botã®ä½œã‚Šæ–¹ 3/3 å¿œç­”å‹ (ã–ã£ãã‚Šã¨)

1. è‡ªèº«ã¸ã®Mention (@<user>ãŒã¤ã„ãŸãƒ„ã‚¤ãƒ¼ãƒˆ)ã‚’å–å¾—ã€ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯2ã¤

1-a. ãƒ—ãƒ­ã‚°ãƒ©ãƒ èµ·å‹•å¾Œã®Mentionã«å¯¾å¿œ

.link https://dev.twitter.com/streaming/userstreams

1-b. ãƒ—ãƒ­ã‚°ãƒ©ãƒ èµ·å‹•å‰ã®Mentionã«ã‚‚å¯¾å¿œï¼šHomeTimeline(è‡ªåˆ†ã®ç™ºè¨€)ã‚’èª¿ã¹ã¦æœ€å¾Œã«è¿”ä¿¡ã—ãŸMentionä»¥é™ã«å¯¾å¿œã™ã‚‹


.link https://dev.twitter.com/rest/reference/get/statuses/home_timeline
.link https://dev.twitter.com/rest/reference/get/statuses/mentions_timeline


2. ãƒ„ã‚¤ãƒ¼ãƒˆã‚’è§£æ

.link https://dev.twitter.com/overview/api/entities
ãƒ„ã‚¤ãƒ¼ãƒˆã®è§£æçµæœãŒå–å¾—å¯èƒ½ (@<user>ã‚’æŠ½å‡ºã€æœ¬æ–‡ã‚’æŠ½å‡º)

3. è¿”ç­”ã™ã‚‹ (é…ä¿¡å‹ã¨åŒã˜)

* ãƒ‡ãƒ¢

* ã‚„ã£ã¦ã¿ã¦æ‰€æ„Ÿ

ğŸ”· dghubble/go-twitter
ç‰¹ã«ä¸æº€ãªã—

ğŸ”·math/big
immutableã§ã¯ãªã„ã®ã§æ‰±ã„ã«æ³¨æ„ãŒå¿…è¦

 // ä¾‹:è¶³ã—ç®— (a += b)
 a.Add(a, b)

ğŸ”·Go Routine & Channel
Channelä¾¿åˆ©ã€‚ç´ æ•°ç”Ÿæˆâ†’ç´ æ•°ãƒ„ã‚¤ãƒ¼ãƒˆã§ä½¿ç”¨


ğŸ”·Twitter APIã®ã‚¢ã‚¯ã‚»ã‚¹é »åº¦
.link https://dev.twitter.com/rest/public/rate-limiting

ã‚¢ã‚¯ã‚»ã‚¹é »åº¦ã‚ªãƒ¼ãƒãƒ¼ãŒèµ·ãã‚‹ã“ã¨ã‚’è€ƒæ…®ã™ã‚‹å¿…è¦ã‚ã‚Š(ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ãªã©ï¼‰

ğŸ”·ç´ æ•°ã‚ªãƒ³ãƒ¡ãƒ¢ãƒªã®é™ç•Œ
OOM KillerãŒã‚„ã£ã¦ãã‚‹ã€‚æ°¸ç¶šåŒ–æ–¹æ³•ã‚’æ¤œè¨ã—ãªã„ã¨ã€ã„ãšã‚Œbotç¶™ç¶šã§ããªã„


* ã¾ã¨ã‚

- Golangæ¥½ã—ã„
- Botæ¥½ã—ã„
